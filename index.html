<!DOCTYPE html>
<html>
<head>
  <title>Google Sheets and Google Charts Integration</title>
  <script src="https://www.gstatic.com/charts/loader.js"></script>
  <script>
    google.charts.load('current', { 'packages': ['corechart'] });
    google.charts.setOnLoadCallback(fetchDataAndDrawChart);

    function fetchDataAndDrawChart() {
      var spreadsheetId = '1lJ5r96UgQgo2NtBgMScndGq1CWBPRq90QOyg_zCODWc';
      var range = 'Sheet30!A:C'; // Replace with your sheet name and range
      var url = 'https://sheets.googleapis.com/v4/spreadsheets/' + spreadsheetId + '/values/' + range;

      fetch(url)
        .then(function(response) {
          return response.json();
        })
        .then(function(data) {
          // Process the retrieved data
          var rows = data.values;

          var chartData = [['Category', 'Value']];
          rows.forEach(function(row) {
            chartData.push(row);
          });

          var chartOptions = {
            title: 'My Chart',
            // Additional customization options
          };

          var chart = new google.visualization.BarChart(document.getElementById('chart-container'));
          chart.draw(google.visualization.arrayToDataTable(chartData), chartOptions);
        });
    }
  </script>
</head>
<body>
  <div id="chart-container"></div>
</body>
</html>
